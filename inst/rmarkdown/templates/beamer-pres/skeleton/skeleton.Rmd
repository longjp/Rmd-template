---
title: "Instrumental Variables and the Causal Dantzig"
author: "James Long"
date: "2/10/2021"
output:
   beamer_presentation:
     keep_tex: true
     includes:
        in_header: header_pagers.tex
---

```{r create-header-pagerns,echo=FALSE}
out <- "\\setbeamertemplate{navigation symbols}{}
         \\setbeamertemplate{footline}[page number]"
cat(out,file="header_pagers.tex")
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

## colorizes text when using html or pdf output
## just spits out text x for word
colorize <- function(x, color) {
  if(color=="todo"){
    color <- "red"
    x <- paste0("TODO: ",x)
  }
  if (knitr::is_latex_output()) {
    sprintf("\\textcolor{%s}{%s}", color, x)
  } else if (knitr::is_html_output()) {
    sprintf("<span style='color: %s;'>%s</span>", color, 
      x)
  } else x
}

todo <- function(x){
  paste0("**",colorize(x,"todo"),"**")
}
```


# Introduction

## Kemmeren Gene Knockout Data

* Measured expression of $\sim 6000$ genes in yeast
* $\sim 300$ observational readings
* $\sim 1400$ single gene knockouts


**Goal:** What genes are causes of $Y$? (Gene $X$ is a cause of $Y$ if when we knock it out, $Y$ expression has large change)


## Environment Approach

* Assume causal DAG with linear structure
* Gene $Y$ expression is linear function of other genes $X \in \mathbb{R}^p$
$$
Y = X^T\beta + \delta_Y
$$
* $\beta_j=0$ implies $X_j$ is not a direct cause of $Y$
* In Kemmeren, observations can be divided into observational and interventional **environments**
* **Environment** based methods for estimating $\beta$
    * **Invariant Causal Prediction (ICP)** (consistent when no confounding)
    * **Causal Dantzig (CD)**
    
## Evaluating Models

* **Training set:** All observational data and $~1000$ interventions
* **Test set:** $~400$ knockouts, so $Z \in \mathbb{R}^{400 \times 6000}$ matrix
* **Significant interventional effect (SIE):** $Z^S \in \{0,1\}^{400 \times 6000}$
   * $Z^S_{i,j} = 1$ if $Z_{i,j}$ outside range of gene $j$ in observational data
   * $Z^S_{i,j} = 0$ otherwise
* **Goal:** Use training data to predict $Z^S$.
